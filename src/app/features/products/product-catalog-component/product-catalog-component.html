<div class="product-catalog">
  <div class="catalog-header">
    <h2>Product Catalog</h2>
    <div class="search-bar">
      <input type="text" [formControl]="searchControl" placeholder="Search products..." class="search-input" />
    </div>
  </div>

  <div class="catalog-filters">
    <div class="filter-chips">
      <button class="filter-chip" [class.active]="selectedCategory() === null" (click)="filterByCategory(null)">
        All Products
      </button>
      @for (category of categories(); track category.id) {
      <button
        class="filter-chip"
        [class.active]="selectedCategory() === category.id"
        (click)="filterByCategory(category.id)"
      >
        {{ category.name }}
      </button>
      }
    </div>

    @if (selectedCategory() !== null || searchControl.value) {
    <button class="clear-filters" (click)="clearFilters()">Clear Filters</button>
    }
  </div>

  @if (errorMessage()) {
  <div class="error-banner">{{ errorMessage() }}</div>
  } @if (isLoading()) {
  <div class="loading-state">
    <div class="spinner"></div>
    <p>Loading products...</p>
  </div>
  } @else { @if (filteredProducts().length === 0) {
  <div class="empty-state">
    <p>No products found.</p>
    @if (searchControl.value || selectedCategory() !== null) {
    <button class="btn-secondary" (click)="clearFilters()">Clear Filters</button>
    }
  </div>
  } @else {
  <div class="product-grid">
    @for (product of filteredProducts(); track product.id) {
    <div class="product-card">
      <div class="product-image">
        <img [src]="product.imageUrl" [alt]="product.name" loading="lazy" />
      </div>
      <div class="product-info">
        <h3 class="product-name">{{ product.name }}</h3>
        <p class="product-brand">{{ product.brand }}</p>
        <div class="product-price">
          <span class="price">{{ product.price | number: '1.2-2' }} z≈Ç</span>
          <span class="unit">/ {{ product.unit }}</span>
        </div>
        <p class="product-category">{{ product.categoryName }}</p>
        <button class="btn-add-to-list" (click)="onProductSelect(product)">+ Add to List</button>
      </div>
    </div>
    }
  </div>
  } }

  <!-- List Selector Modal -->
  <app-list-selector-modal></app-list-selector-modal>
</div>
